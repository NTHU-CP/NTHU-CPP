<!DOCTYPE HTML>
<html lang="zh-TW" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>BCC-Vertex and BCC-Edge - NTHU CPP</title>


        <!-- Custom HTML head -->
        <meta name="google-site-verification" content="aHI6EvEvMoCy151ZL2UYTQxmetpqMtOPEYb4Mm2luAw" />
        
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-F8EBK1EKYT"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-F8EBK1EKYT');
        </script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../others/foreword.html">Foreword</a></li><li class="chapter-item "><a href="../others/calendar.html">2023 Calendar</a></li><li class="chapter-item "><a href="../contest/intro.html">Contests</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../contest/ncpc.html">NCPC</a></li><li class="chapter-item "><a href="../contest/topc.html">TOPC</a></li><li class="chapter-item "><a href="../contest/icpc.html">ICPC</a></li></ol></li><li class="chapter-item "><a href="../others/how_to_practice.html">How to Practice</a></li><li class="chapter-item "><a href="../others/contribution.html">Contribute to NTHU CPP</a></li><li class="spacer"></li><li class="chapter-item "><div>Fundemantal</div></li><li class="chapter-item "><div>Data Structure</div></li><li class="chapter-item "><a href="../greedy/intro.html">Greedy</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../greedy/basic.html">Basic Greedy</a></li></ol></li><li class="chapter-item "><div>Dynamic Programming</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../dp/convex_hull_optimization.html">Convex Hull Optimization</a></li></ol></li><li class="chapter-item expanded "><div>Graph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Tree</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graph/lca.html">Lowest Common Ancestor</a></li></ol></li><li class="chapter-item "><a href="../graph/introduction_to_AP_bridge.html">Articulation Point and Bridge</a></li><li class="chapter-item expanded "><a href="../graph/introduction_to_BCC.html" class="active">BCC-Vertex and BCC-Edge</a></li></ol></li><li class="chapter-item "><div>Flow</div></li><li class="chapter-item "><a href="../sqrt/intro.html">Sqrt Technique</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../sqrt/sqrt_decomposition.html">Square Root Decomposition</a></li></ol></li><li class="chapter-item "><a href="../math/intro.html">Mathematics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../math/introduction_to_generating_function.html">Generating Function</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../math/gf_recurrence.html">Solving Recurrence</a></li><li class="chapter-item "><a href="../math/gf_combination.html">Combination</a></li><li class="chapter-item "><a href="../math/lagrange_inversion_theorem.html">Lagrange Inversion Theorem</a></li><li class="chapter-item "><a href="../math/gf_multiple_variables.html">Multiple Variables</a></li></ol></li><li class="chapter-item "><a href="../math/introduction_to_arithmetic_function.html">Arithmetic Function</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../math/linear_sieve.html">Linear Sieve</a></li><li class="chapter-item "><a href="../math/sqrt_decomposition.html">數論分塊</a></li><li class="chapter-item "><a href="../math/du_sieve.html">杜教篩</a></li><li class="chapter-item "><a href="../math/revisit_arithmetic_function.html">Arithmetic Function Revisit</a></li></ol></li><li class="chapter-item "><a href="../math/fast_fourier_transform.html">Fast Fourier Transform</a></li></ol></li><li class="chapter-item "><div>Miscellaneous</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../misc/interactive.html">Interactive Problems</a></li><li class="chapter-item "><a href="../misc/game_theory.html">Game Theory</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../misc/nim_and_sg_value.html">Nim and Sprague-Grundy Theorem</a></li></ol></li></ol></li><li class="chapter-item "><div>C++ Programming Tips</div></li><li class="spacer"></li><li class="chapter-item "><a href="../others/codebook.html">Make a Codebook</a></li><li class="chapter-item "><a href="../others/useful_resources.html">Useful Resources</a></li><li class="chapter-item "><div>CSES Problem Tag</div></li><li class="chapter-item "><a href="../others/hwtc.html">Happy Winter Training Camp</a></li><li class="chapter-item "><a href="../others/happy_meeting.html">Weekly Happy Meeting</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">NTHU CPP</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/NTHU-CP/NTHU-CPP" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bcc-vertex-and-bcc-edge"><a class="header" href="#bcc-vertex-and-bcc-edge">BCC-Vertex and BCC-Edge</a></h1>
<h2 id="前言"><a class="header" href="#前言">前言</a></h2>
<p>在此章節中，我們將介紹無向圖上的 BCC-Vertex(Bi-connected Component) 和 BCC-Edge(Bridge Connected Component)，包括他們的定義、相關的演算法和題目。</p>
<h2 id="bcc-vertexbi-connected-component"><a class="header" href="#bcc-vertexbi-connected-component">BCC-Vertex(Bi-connected Component)</a></h2>
<p>BCC-Vertex 指的是沒有 AP 的 Connected Component，在中文常稱之為點雙連通分量。例如下圖中有三個 BCC-Vertex</p>
<img src="image/BCC/BiConnected_Component.JPG" width="300" style="display:block; margin: 0 auto;"/>
<p>BCC-Vertex 有以下幾個性質:</p>
<ul>
<li>
<p>不同的 BCC-Vertex 之間最多共用一個點，而該點必然是圖上的 AP</p>
<ul>
<li>如果共用超過一個點的話，我們會發現這兩個 BCC-Vertex 實際上是同一個。如下圖，我們發現刪掉這兩個點中的任一個點，整張圖依然彼此連通；而如果刪掉的是某個 BCC-Vertex 內的點，根據 BCC-Vertex 的定義，整張圖也會保持連通。因此得證這兩個 BCC-Vertex 實際上是同一個
<img src="image/BCC/BCC-Vertex_property_1_proof1.JPG" width="300" style="display:block; margin: 0 auto;"/></li>
</ul>
</li>
<li>
<p>一個至少有三個點的 BCC-Vertex，給定任意兩相異點 \( a,b \)，必存在一個同時包含 \(a,b\) 兩點的簡單環</p>
<ul>
<li>首先我們知道，\( a \) 點一定會位於某個簡單環中，否則拿掉 \( a \) 點後整張圖必不連通。\( b \) 點同理。</li>
<li>如果兩個簡單環至少交於兩點，那我們便可以找出一個同時包含 \(a, b\) 的簡單環，如下圖。
<img src="image/BCC/BCC-Vertex_simple_cycle_1.JPG" width="300" style="display:block; margin: 0 auto;"/></li>
<li>如果兩個簡單環恰交於一點，即下圖的綠點。因為 \(a, b\) 位於同一個 BCC-Vertex，因此我們知道，\( a \) 的簡單環上一定會有一條不經過綠點的 path 通向 \( b \) 的簡單環，否則綠點就會是 AP。那我們便可以找出一個同時包含 \(a, b\) 的簡單環，如下圖。
<img src="image/BCC/BCC-Vertex_simple_cycle_2.JPG" width="300" style="display:block; margin: 0 auto;"/></li>
<li>如果兩個簡單環沒有交集，根據 BCC-Vertex 的定義，我們知道 \( a \) 的簡單環上一定會有通向 \( b \) 的簡單環的 path，而且這些 path 至少會從兩個不同的點出發(如果只由一個點出發，那麼那個點就會是 AP，如下圖的紅點)。
<img src="image/BCC/BCC-Vertex_simple_cycle_3.JPG" width="300" style="display:block; margin: 0 auto;"/></li>
<li>如果我們找到兩條沒有共用點的 path，那我們便可以找出一個同時包含 \(a, b\) 的簡單環，如下圖。
<img src="image/BCC/BCC-Vertex_simple_cycle_4.JPG" width="300" style="display:block; margin: 0 auto;"/></li>
<li>否則，發現我們可以<strong>擴大</strong> \( a \) 的簡單環，如下圖。因為 \( a \) 的簡單環會不斷往 \( b \) 的方向長大，而圖的大小有限，因此我們知道有限回合後，兩個簡單環必定相交。
<img src="image/BCC/BCC-Vertex_simple_cycle_Enlarge.JPG" width="400" style="display:block; margin: 0 auto;"/></li>
</ul>
</li>
<li>
<p>一個至少有三個點的 BCC-Vertex，任兩點間至少會有兩條沒有共用邊的簡單路徑。(環上順時針或逆時針走)</p>
</li>
<li>
<p>對於在同一個 BCC-Vertex 中的任意三個相異點 \( a,b,c \)，必存在一條簡單路徑依序經過 \(a,b,c\) 三點。</p>
<ul>
<li>因為 \(a,b\) 同在一個環上，\(b,c \) 同在一個環上，所以我們枚舉兩個環跟三個點的各種位置關係就能得證。以下列舉幾種，紅色的邊代表 \( a \) 到 \( b \) 到 \( c \) 的簡單路徑</li>
</ul>
</li>
</ul>
<img src="image/BCC/BCC-Vertex_Cycle_Case.JPG" width="300" style="display:block; margin: 0 auto;"/>
<ul>
<li>把每個 BCC-Vertex 跟 AP 都縮成一個點，根據 BCC-Vertex 與 AP 的連接關係畫成一張新圖，那這張新圖會是一棵樹或森林，且樹上的 AP 跟 BCC-Vertex 會交錯出現
<ul>
<li>以下是一個縮點的例子
<img src="image/BCC/BCC-Vertex_property_4_example.JPG" width="400" style="display:block; margin: 0 auto;"/></li>
<li>新的圖上不可能有環，否則圖上的 AP 就不會是 AP。
<img src="image/BCC/BCC-Vertex_property_4_proof.JPG" width="300" style="display:block; margin: 0 auto;"/></li>
<li>而且樹上的 AP 跟 BCC-Vertex 會交錯出現這點我們可以從第一點推出。</li>
</ul>
</li>
</ul>
<p>而要如何找出圖上所有的 BCC-Vertex 呢？我們發現:</p>
<ul>
<li>對於那些不是 AP 的點，可以通過 DFS 找出所有與他同屬一個 BCC-Vertex 的點(當我們遇到 AP 時就不要再 DFS 下去即可)</li>
<li>對於 AP，只要檢查他周圍的點有沒有 AP，有的話這兩個 AP 就會形成一個 BCC-Vertex。</li>
</ul>
<p>例如下圖中，\( A \) 通過 DFS 可以找到 \( B,C,D \)，這四點恰為一個 BCC-Vertex。\( A \) 點不會找到 \( E \)，因為 \( D \) 點是 AP，不會繼續 DFS 下去。而 \(D \) 點會檢查到 \(E \) 是 AP，因此 \(D,E\) 會是一個 BCC-Vertex。</p>
<img src="image/BCC/simple_BCC-Vertex_example.JPG" width="300" style="display:block; margin: 0 auto;"/>
<p>事實上，我們也可以通過修改找 AP 的演算法，在找 AP 的時候順便找出所有的 BCC-Vertex。</p>
<h3 id="如何修改"><a class="header" href="#如何修改">如何修改</a></h3>
<p>我們可以用 stack 紀錄首次遇到的邊。這樣當我們發現 \(low(v) \geq depth(u) \) 時，stack 中 \( (u,v) \) 及它上面的邊就會位於同一個 BCC-Vertex 中。就像是下圖 \( (C,D) \) 這條邊。</p>
<img src="image/BCC/BCC_Algo_explain.png" width="300" style="display:block; margin: 0 auto;"/>
<p>一個完整的例子如下
<img src="image/BCC/BCC_Algo_example.gif" width="300" style="display:block; margin: 0 auto;"/></p>
<h3 id="time-complexity"><a class="header" href="#time-complexity">Time Complexity</a></h3>
<p>做完一次 DFS 就會有答案。而每條邊只會被 push 跟 pop 一次，因此 Time Complexity 為 \( O(V+E) \)</p>
<h3 id="code"><a class="header" href="#code">code</a></h3>
<pre><code class="language-cpp">struct BCC_Vertex {
    vector&lt;int&gt; low, depth;
    vector&lt;vector&lt;int&gt;&gt; G;
    vector&lt;vector&lt;pair&lt;int, int&gt;&gt;&gt; bcc;
    stack&lt;pair&lt;int, int&gt;&gt; stk;
    
    void init(int n) {
        depth.assign(n+1, 0);
        low.assign(n+1, 0);
        G.assign(n+1, vector&lt;int&gt;());
        bcc.clear();
    }
    
    void add_edge(int u, int v) {
        G[u].emplace_back(v);
        G[v].emplace_back(u);
    }
    
    void solve(int root) {
        dfs(root, root, 1);
    }
    
    void dfs(int u, int parent, int dep) {
    
        depth[u] = low[u] = dep;
    
        for(auto &amp;v : G[u]) {
            if(v == parent) continue;
            if(depth[v] &lt; depth[u]) stk.emplace(u,v);
            if(depth[v] == 0) {
                dfs(v, u, dep+1);
                low[u] = min(low[v], low[u]);
                if(low[v] &gt;= depth[u]) {
                    pair&lt;int, int&gt; x;
                    bcc.emplace_back(vector&lt;pair&lt;int, int&gt;&gt;());
                    do {
                        x = stk.top(); stk.pop();
                        bcc.back().emplace_back(x);
                    } while(x != make_pair(u,v));
                }
            } else {
                low[u] = min(low[u], depth[v]);
            }
        }
        
        if(u == parent) {
            while(!stk.empty()) {
                pair&lt;int, int&gt; x;
                bcc.emplace_back(vector&lt;pair&lt;int, int&gt;&gt;());
                do {
                    x = stk.top(); stk.pop();
                    bcc.back().emplace_back(x);
                } while(x.first != 1);
            }
        }
    }
    
    auto get_BCC_Vertex() {
        return bcc;
    }
};
</code></pre>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<blockquote>
<p><a href="https://codeforces.com/gym/102835/problem/I">The 2020 ICPC Asia Taipei-Hsinchu Site Programming Contest pI - Critical Structures</a></p>
<p>請有興趣的讀者自行去連結查看題目敘述，以免暴雷未來打算模擬這屆台北站當作團練的人。</p>
</blockquote>
<details><summary> Solution </summary>
<p>題目要找 AP, bridge, BCC-Vertex 的數量，以及擁有最多邊的 BCC-Vertex 的邊數。</p>
<p>其實就是模板題</p>
</details>
<blockquote>
<p><a href="https://codeforces.com/problemset/problem/962/F">Codeforce - Simple Cycles Edges</a></p>
<p>給定一張 \( N \) 個點 \( M \) 條邊的無向圖，問那些邊剛好位於一個簡單環上。</p>
<p>\(1 \leq N \leq 10^5,\ 0 \leq M \leq min(n \cdot (n-1)/2,\ 2.1 \cdot 10^6)\)</p>
</blockquote>
<details><summary> Solution </summary>
<p>我們首先觀察到答案一定不會跨過兩個 BCC-Vertex。因此我們只要對每個 BCC-Vertex 分別檢查即可。</p>
<p>而 BCC-Vertex 中所有的邊要剛好位於一個簡單環上，那代表說我們只要檢查 BCC-Vertex 中點數和邊數是否相等，就能知道一條邊是否恰位於一個簡單環上。</p>
</details>
<h2 id="bcc-edgebridge-connected-component"><a class="header" href="#bcc-edgebridge-connected-component">BCC-Edge(Bridge Connected Component)</a></h2>
<p>BCC-Edge 指的是沒有 bridge 的 Connected Component，在中文常稱之為邊雙連通分量、橋連通分量。例如下圖我們能找到兩個 BCC-Edge
<img src="image/BCC/Bridge_Connected_Component.JPG" width="300" style="display:block; margin: 0 auto;"/></p>
<p>BCC-Edge 有以下幾個性質</p>
<ul>
<li>一個 BCC-Edge 中任一條邊都至少在一個簡單環上。
<ul>
<li>我們可以反證：如果一條邊 \((u,v)\) 不在任何簡單環上，那麼刪掉 \((u,v)\) 後 \( u \) 跟 \( v \) 就不會連通，違反 BCC-Edge 的規定。</li>
</ul>
</li>
<li>如果把每個 BCC-Edge 縮成一個點，那麼新得到的圖會是一棵樹或者森林。
<ul>
<li>因為如果新的圖上有環的話，那個環上所有的點就應在一開始被看成一個 BCC-Edge。如下圖所示，那三個 BCC-Edge 應該要同在一個 BCC-Edge 中。</li>
</ul>
</li>
</ul>
<img src="image/BCC/BCC-Edge_property_2.JPG" width="400" style="display:block; margin: 0 auto;"/>
<p>而要如何找出圖上所有的 BCC-Edge？我們可以發現，如果我們拔掉原圖上所有的 bridge，那麼剩下來的每一個 component 就都會是一個 BCC-Edge。</p>
<img src="image/BCC/simple_BCC-Edge_example.JPG" width="300" style="display:block; margin: 0 auto;"/>
<p>因此我們可以拔掉圖上所有的 bridge 後，DFS 找出那些點同屬一個 BCC-Edge。那有沒有其他方法呢？與 BCC-Vertex 相似，我們可以通過修改找 bridge 的演算法，在找 bridge 的時候順便找出所有的 BCC-Edge。</p>
<h3 id="如何修改-1"><a class="header" href="#如何修改-1">如何修改</a></h3>
<p>跟找 BCC-Vertex 的想法很像。我們用 stack 紀錄走過的點，當我們發現 \(low(u) == depth(u) \) 時，我們就發現了橋的下端點。而 stack 中 \(u \) 和他上面的點就會位於同一個 BCC-Edge。就像下圖 \( D \) 這個點，他是 \( (C,D) \) 這條 bridge 的下端點。</p>
<img src="image/BCC/BCC_Algo_explain_2.png" width="300" style="display:block; margin: 0 auto;"/>
<p>一個完整的例子如下
<img src="image/BCC/BCC_Algo_example_2.gif" width="300" style="display:block; margin: 0 auto;"/></p>
<h3 id="time-complexity-1"><a class="header" href="#time-complexity-1">Time Complexity</a></h3>
<p>做完一次 DFS 就會有答案。而每個點只會被 push 跟 pop 一次，因此 Time Complexity 為 \( O(V+E) \)</p>
<h3 id="code-1"><a class="header" href="#code-1">code</a></h3>
<pre><code class="language-cpp">struct BCC_Edge {
    vector&lt;int&gt; low, depth;
    vector&lt;vector&lt;int&gt;&gt; G;
    vector&lt;vector&lt;int&gt;&gt; bcc;
    stack&lt;int&gt; stk;
    
    void init(int n) {
        depth.assign(n+1, 0);
        low.assign(n+1, 0);
        G.assign(n+1, vector&lt;int&gt;());
        bcc.clear();
        while(!stk.empty()) stk.pop();
    }
    
    void add_edge(int u, int v) {
        G[u].emplace_back(v);
        G[v].emplace_back(u);
    }
    
    void solve(int root) {
        dfs(root, root, 1);
    }
    
    void dfs(int u, int parent, int dep) {
        depth[u] = low[u] = dep;
        stk.emplace(u);
    
        for(auto &amp;v : G[u]) {
            if(v == parent) continue;
            if(depth[v] == 0) {
                dfs(v, u, dep+1);
                low[u] = min(low[v], low[u]);
            } else {
                low[u] = min(low[u], depth[v]);
            }
        }
        
        if(low[u] == depth[u]) {
            bcc.emplace_back(vector&lt;int&gt;());
            int x;
            do {
                x = stk.top(); stk.pop();
                bcc.back().emplace_back(x);
            } while(x != u);
        }
    }
    
    auto get_BCC_Edge() {
        return bcc;
    }
};
</code></pre>
<h2 id="exercise-1"><a class="header" href="#exercise-1">Exercise</a></h2>
<blockquote>
<p><a href="https://codeforces.com/gym/100712">2015 ACM Amman Collegiate Programming Contest pH - Bridges</a></p>
<p>\( T \) 筆測資，每筆測資會給你一張 \( N \) 個點 \( M \) 條邊的無向圖，問你在圖上加一條邊後，圖上的 bridge 數量最少為何。</p>
<p>\(1 \leq T \leq 64\)</p>
<p>\(3 \leq N \leq 10^5,\ N-1 \leq M \leq 10^5\)</p>
</blockquote>
<details><summary> Solution </summary>
<p>我們首先把所有的 BCC-Edge 縮點，根據 BCC-Edge 的性質我們會得到一棵樹，樹上的邊都是 bridge。</p>
<p>我們思考如果在樹上 \( u,v \) 兩點間加上一條邊後，有哪些邊就不再是 bridge 了。可以發現樹上從 \( u \) 到 \( v \) path 上的所有邊都不再是 bridge。而我們想要讓最多的 bridge 消失，因此問題就轉換為了求樹的直徑。</p>
</details>
<h2 id="problems"><a class="header" href="#problems">Problems</a></h2>
<blockquote>
<p><a href="https://tioj.ck.tp.edu.tw/problems/1684">TIOJ - 圓桌武士</a></p>
<p>有 \( N \) 個武士和 \( M \) 個武士之間倆倆的仇恨關係，如果能選出奇數個武士(至少三個)坐在圓桌邊，且相鄰的兩人不互相仇恨，那他們就可以開會。問有多問有多少位武士永遠不可能開會。</p>
<p>\( 1 \leq N \leq 1000,\ 1 \leq M \leq 10^6 \)</p>
</blockquote>
<details><summary> Hint </summary>
<p>反過來思考，我們改成找可以和別人開會的武士有誰。我們可以觀察原圖的補圖 (即武士之間的不仇恨關係)，想想看這張補圖上符合怎樣性質的點至少可以參與到一場會議中。</p>
</details>
<blockquote>
<p><a href="https://codeforces.com/contest/732/problem/F">Codeforces - Tourist Reform</a></p>
<p>給定一張 \( N \) 個點 \( M \) 條邊的無向圖，定義 \(r_i \) 為幫每條邊定向後，\(i \) 點可以走到的點數。要你給出一種定向方法使得 \(min_i({r_i})\) 最大</p>
<p>\( 2 \leq N \leq 4 \cdot 10^5,\ 1 \leq M \leq 4 \cdot 10^5 \)</p>
</blockquote>
<details><summary> Hint </summary>
<p>找出所有的 BCC-Edge 後，想想看最大化的 \(min_i({r_i})\) 至少會等於什麼？</p>
</details>
<blockquote>
<p><a href="http://poj.org/problem%EF%BC%9Fid=3352">POJ - Road Construction</a></p>
<p>給一張 \( N \) 個點 \( M \) 條邊的無向圖，保證整張圖連通，問最少要加幾條邊才能使得圖上沒有橋。</p>
<p>\( 3 \leq N \leq 1000,\ 2 \leq M \leq 1000 \)</p>
</blockquote>
<details><summary> Hint </summary>
<p>跟 BCC-Edge 的練習題有點像，想想看縮點後的樹上 leaf 之間要怎樣加邊。</p>
</details>
<h2 id="reference"><a class="header" href="#reference">Reference</a></h2>
<ul>
<li><a href="https://oi-wiki.org/graph/bcc/">oi-wiki - BCC</a></li>
<li><a href="https://www.hackerearth.com/practice/algorithms/graphs/biconnected-components/tutorial/">Hackerearth - BCC</a></li>
<li><a href="https://web.ntnu.edu.tw/~algo/ConnectedComponent.html#2">演算法筆記 - Connected Component</a></li>
<li><a href="https://slides.com/sylveon/graph-7#/4">sylveon slides - BCC</a></li>
<li><a href="https://www.cnblogs.com/IltzInstallBI/p/13113566.html">算法笔记 - BCC</a></li>
<li><a href="https://tioj.ck.tp.edu.tw/uploads/attachment/5/33/8.pdf">建中培訓講義 - 進階圖論</a></li>
<li>清大競程上課講義</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../graph/introduction_to_AP_bridge.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../sqrt/intro.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../graph/introduction_to_AP_bridge.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../sqrt/intro.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
